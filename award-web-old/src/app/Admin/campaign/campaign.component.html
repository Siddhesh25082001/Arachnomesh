<app-admin-dashboard-header></app-admin-dashboard-header>
<!-- Main content -->
<div class="main main-content admin-dashboard" id="panel">

  <div class="header bg-primary pb-6">
    <div class="container-fluid">
      <div class="header-body">
        <div class="row align-items-center py-4">
          <div class="col-lg-6 col-7">
            <h6 class="h2 text-white d-inline-block mb-0">Campaign</h6>
          </div>
          <div class="col-lg-6 col-5 text-right">
            <a (click)="commonService.logout()" class="btn btn-neutral my-4">Logout</a>
            <!-- <button  >Open Modal</button> -->
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Page content -->
  <div class="container-fluid mt--6">
    <div class="row">
      <div class="col">
        <div class="card">
          <!-- Card header -->
          <div style=" display: flex; ">
            <div class="card-header border-0" style=" padding-right: 400px; ">
              <h3 class="mb-0">Campaign</h3>
            </div>

            <div>
              <label class="form-control-label" for="" style="margin-top: 10px">From</label>
              <input
                class="form-control"
                type="date"
                name=""
                id=""
                (input)="filterDataCampaign()"
                [(ngModel)]="from"
              />
            </div>
            <div>
              <label class="form-control-label" for="" style="margin-top: 10px">To</label>
              <input
                class="form-control"
                type="date"
                name=""
                id=""
                [(ngModel)]="to"
                (input)="filterDataCampaign()"
              />
            </div>

            <div style =" margin-bottom: 20px; padding-top: 10px; margin-left: 10px;">
              <label class="form-control-label" for="">Group By</label>
              <select class="form-control" [(ngModel)]="group" (change)="getGroupName()">
                 
                <option value="name">Name</option>              
                <option value="region">Region</option>
                <option value="date">Date</option>
                
              </select>
            </div>

            <div  class="card-header border-0" style="margin-left: 20px;">
              <a  class="btn btn-sm btn-primary" style=" color: aliceblue;margin-top: 30px;" (click)="goBackButton()" >
                 Go Back
              </a>
            </div>
          </div>
          
         <!-- Group by name -->
          <div *ngIf="group=='name' && dataList?.length == 0"  class="table-responsive">
           <table class="table align-items-center table-flush">
                        <thead class="thead-light">
                          <tr >
                            <th scope="col" class="sort" data-sort="status">Campaign Name</th>
                            <th scope="col" class="sort" data-sort="status">Latest Date</th>
                            <th scope="col" class="sort" data-sort="status">Clicks</th>
                            
                            <th scope="col" class="sort" data-sort="completion">Expand</th>
          
                          </tr>
                        </thead>
                        
                      <tbody class="list">
                        <tr *ngFor="let item of groupList">
                            
                                <td class="budget">
                                  {{item?._id.slice(0,20)}}
                                </td>
                                <td>
                                  {{item?.lastDoc.slice(0,10)}}
                                </td>
                                <td>
                                  {{item?.count}}
                                </td>
                                <td>
                                    <i class="fa fa-plus" style=" cursor: pointer;margin-left: 15px;" (click)="getExpandedData(item?._id)"></i>
                                </td>
                              </tr>
                            
                          </tbody>
                        </table>
        </div>
        <!-- Group by region -->
        <div *ngIf="group=='region' && dataList?.length == 0"  class="table-responsive">
          <table class="table align-items-center table-flush">
                       <thead class="thead-light">
                         <tr>
                           <th scope="col" class="sort" data-sort="status">Region</th>
                           <th scope="col" class="sort" data-sort="status">Latest Date</th>
                           <th scope="col" class="sort" data-sort="status">Clicks</th>
                           <th scope="col" class="sort" data-sort="completion">Expand</th>
         
                         </tr>
                       </thead>
                       
                     <tbody class="list">
                       <tr *ngFor="let item of groupList">
                           <!-- <tr *ngIf='item?.fields?.region == region'> -->
                            <td class="budget">
                              {{item?._id}}
                            </td>
                            <td>
                              {{item?.lastDoc.slice(0,10)}}
                            </td>
                            <td>
                              {{item?.count}}
                            </td>
                               <td>
                                   <i class="fa fa-plus" style=" cursor: pointer;margin-left: 15px;" (click)="getExpandedData(item?._id)"></i>
                               </td>
                             </tr>
                           <!-- </tr> -->
                         </tbody>
                       </table>
       </div>
       <!-- Group by date -->
       <div *ngIf="group=='date' && dataList?.length == 0"  class="table-responsive">
        <table class="table align-items-center table-flush">
                     <thead class="thead-light">
                       <tr>
                         
                         <th scope="col" class="sort" data-sort="status">Date</th>
                         <th scope="col" class="sort" data-sort="status">Clicks</th>
                         <th scope="col" class="sort" data-sort="completion">Expand</th>
       
                       </tr>
                     </thead>
                     
                   <tbody class="list">
                     <tr *ngFor="let item of groupList">
                         <!-- <tr *ngIf='item?.fields?.region == region'> -->
                          <td class="budget">
                            {{item?._id}}
                          </td>
                          <td>
                            {{item?.count}}
                          </td>
                             <td>
                                 <i class="fa fa-plus" style=" cursor: pointer;margin-left: 15px; " (click)="getExpandedData(item?._id)"></i>
                             </td>
                           </tr>
                         <!-- </tr> -->
                       </tbody>
                     </table>
              </div>
     <!-- Expanded table -->
          <div class="table-responsive" *ngIf="dataList?.length > 0">
            <table class="table align-items-center table-flush">
                         <thead class="thead-light">
                           <tr>
                             <th scope="col" class="sort" data-sort="status">Campaign</th>
                             <th scope="col" class="sort" data-sort="status">Date</th>
                             <th scope="col" class="sort" data-sort="completion">Region Name</th>
                             <th scope="col" class="sort" data-sort="completion">View Information</th>
           
                           </tr>
                         </thead>
                         
                       <tbody class="list">
                         <tr *ngFor="let item of dataList">
                             
                                 <td class="budget">
                                   {{item?.fields?.value}}
                                 </td>
                                 <td>
                                   {{item?.createdAt | date}}
                                 </td>
                                 <td>
                                   {{item?.fields?.region}}
                                 </td>
                                 <td>
                                     <i class="icon-eye" style=" cursor: pointer; " (click)="viewDetails(item?.fields)"
                                      data-toggle="modal" data-target="#loginModal"></i>
                                 </td>
                               </tr>
                            
                           </tbody>
                         </table>
             </div>
  
      </div>
          <nav *ngIf="dataList?.length == 0"  aria-label="Page navigation example">
  <ul class="pagination justify-content-end">
    <li class="page-item">
      <a class="page-link" aria-label="Previous" (click)="previousPage()">
        <span aria-hidden="true" >&laquo;</span>
      </a>
    </li>
    <li class="page-item text-white mt-2">
        {{currentPage}} of {{totalPage}}
    </li>
 
     <li class="page-item">
      <a class="page-link" aria-label="Next" (click)="nextPage()">
        <span aria-hidden="true">&raquo;</span>
      </a>
    </li>
  </ul>
        </nav>
    </div>
  </div>
</div>
</div>
<div class="modal fade login" id=loginModal>
  <div class="modal-dialog login animated">
    <div class="modal-content" *ngIf="modalDataKey && modalDataKey.length > 0">
      <div class="modal-header"><button aria-hidden="true" class="close" data-dismiss="modal" type="button">Ã—</button>
      </div>
      <div class="modal-body" style=" overflow-x: scroll; ">
        <table class="table align-items-center table-flush">
          <tbody class="list">
            <tr *ngFor="let key of modalDataKey">
              <th class="sort" data-sort="name" scope="col">{{key}}</th>
              <td class="budget">{{modalData[key]}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>